---

- name: Ensure python-is-python3 is installed
  become: yes
  package:
    name: python-is-python3
    state: present

- name: Install Docker role
  include_role:
    name: geerlingguy.docker
  vars:
    docker_users:
      - ubuntu


- name: Clone EMGB Repo
  git:
    repo: "{{emgb_vars.emgb_repo}}"
    dest: "{{emgb_vars.repo_path}}"
    version: "{{emgb_vars.emgb_version}}"

- name: Copy docker-compose.override
  ansible.builtin.copy:
    src: docker-compose.override.yml
    dest: "{{emgb_vars.repo_path}}"

- name: Run docker-compose EMGB
  ansible.builtin.command:
    cmd: docker-compose up -d
  args:
    chdir: "{{emgb_vars.repo_path}}"


